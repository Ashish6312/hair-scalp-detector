<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Find a Specialist - Hair & Scalp AI</title>
    {% load static %}
    <link
      rel="icon"
      type="image/png"
      href="{% static 'images/favicon.png' %}"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      /*
        ==========================================================================
        * File: style.css (Consolidated)
        * Project: Hair and Scalp Disease Prediction
        * Description: Global styles from home.html combined with page-specific
        * styles for the "Find a Specialist" page.
        ==========================================================================
        */

      /* --- CSS Variables (Root) --- */
      :root {
        --primary-color: #14b8a6; /* Teal */
        --secondary-color-bg: #f3f4f6; /* Light Gray Background */
        --accent-color: #10b981; /* Encouraging Green CTA */
        --text-dark: #1f2937; /* Dark Charcoal Text */
        --text-light: #6b7280; /* Medium Gray Subtitles */
        --white-color: #ffffff;
        --border-color: #e5e7eb;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07),
          0 2px 4px -2px rgba(0, 0, 0, 0.07);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -4px rgba(0, 0, 0, 0.1);
        --border-radius: 12px;
        --transition-speed: 0.3s ease;
      }

      [data-theme="dark"] {
        --secondary-color-bg: #111827;
        --text-dark: #f3f4f6;
        --text-light: #9ca3af;
        --white-color: #1f2937;
        --border-color: #374151;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3),
          0 2px 4px -2px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.4),
          0 4px 6px -4px rgba(0, 0, 0, 0.4);
      }

      /* --- General & Base Styles --- */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: "Poppins", sans-serif;
        line-height: 1.6;
        color: var(--text-dark);
        background-color: var(--secondary-color-bg);
        transition: background-color var(--transition-speed),
          color var(--transition-speed);
      }

      main {
        padding-top: 100px; /* Offset for fixed navbar */
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }
      .clinic-info li a {
        color: inherit; /* Makes the link inherit the text color from its parent */
        text-decoration: none; /* Removes the underline */
      }
      .clinic-info li a:hover {
        color: var(--primary-color); /* Changes color on hover for better UX */
      }

      /* --- Navigation (from home.html) --- */
      .navbar {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        z-index: 1000;
        padding: 1rem 0;
        border-bottom: 1px solid transparent;
        transition: all var(--transition-speed);
      }
      [data-theme="dark"] .navbar {
        background: rgba(31, 41, 55, 0.8);
      }
      .navbar.scrolled {
        padding: 0.75rem 0;
        box-shadow: var(--shadow);
        border-bottom-color: var(--border-color);
      }
      .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 1rem;
      }
      .logo {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-color);
      }
      .nav-links {
        display: flex;
        list-style: none;
        gap: 2rem;
        align-items: center;
      }
      .nav-links a {
        text-decoration: none;
        color: var(--text-dark);
        font-weight: 500;
        transition: color var(--transition-speed);
        position: relative;
        padding-bottom: 5px;
      }
      .nav-links a:hover {
        color: var(--primary-color);
      }
      .nav-links a::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--primary-color);
        transition: width var(--transition-speed);
      }
      .nav-links a:hover::after {
        width: 100%;
      }
      .theme-toggle {
        background: var(--white-color);
        border: 1px solid var(--border-color);
        color: var(--text-light);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        transition: all var(--transition-speed);
        font-size: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .theme-toggle:hover {
        color: var(--primary-color);
        transform: rotate(15deg);
      }

      /* --- Page Specific Styles: Find a Specialist --- */
      .section-title {
        text-align: center;
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--text-dark);
        margin-bottom: 1rem;
      }
      .section-subtitle {
        text-align: center;
        font-size: 1.1rem;
        color: var(--text-light);
        margin-bottom: 3rem;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }
      .filter-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 2rem;
        background-color: var(--white-color);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        margin-bottom: 2rem;
        border: 1px solid var(--border-color);
      }
      .form-group {
        display: flex;
        flex-direction: column;
      }
      .form-group label {
        font-weight: 500;
        margin-bottom: 0.5rem;
        color: var(--text-light);
        font-size: 0.9rem;
      }
      .form-group select,
      .form-group input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        font-size: 1rem;
        font-family: inherit;
        background-color: var(--secondary-color-bg);
        color: var(--text-dark);
        transition: all var(--transition-speed);
      }
      .form-group select:focus,
      .form-group input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.2);
      }
      .search-button {
        grid-column: 1 / -1;
        margin-top: 1rem;
        background: var(--accent-color);
        color: white;
        border: none;
        padding: 0.8rem;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all var(--transition-speed);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }
      .search-button:hover {
        background-color: #059669;
        transform: translateY(-2px);
      }
      .results-map-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      #map {
        height: 400px;
        width: 100%;
        border-radius: var(--border-radius);
        background-color: var(--border-color);
        border: 1px solid var(--border-color);
      }
      .results-container {
        max-height: 600px;
        overflow-y: auto;
        padding-right: 10px;
      }
      .no-results {
        padding: 3rem 1rem;
        text-align: center;
        color: var(--text-light);
        background-color: var(--white-color);
        border-radius: var(--border-radius);
      }
      .clinic-card {
        background-color: var(--white-color);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        transition: all var(--transition-speed);
        margin-bottom: 1.5rem;
        cursor: pointer;
      }
      .clinic-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
      }
      .clinic-card.highlighted {
        border-color: var(--primary-color);
        box-shadow: var(--shadow-lg), 0 0 0 3px rgba(20, 184, 166, 0.3);
      }
      .clinic-card h3 {
        font-size: 1.2rem;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
      }
      .clinic-info {
        list-style: none;
        margin-bottom: 1.5rem;
        font-size: 0.9rem;
      }
      .clinic-info li {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        color: var(--text-light);
        margin-bottom: 0.75rem;
      }
      .clinic-info li i {
        color: var(--primary-color);
        width: 16px;
        text-align: center;
        margin-top: 4px;
      }
      .rating {
        color: #f59e0b;
      }

      /* --- Footer (from home.html) --- */
      .footer {
        background: var(--text-dark);
        color: #a0aec0;
        padding: 4rem 1rem 2rem;
        transition: background-color var(--transition-speed),
          color var(--transition-speed);
      }

      [data-theme="dark"] .footer {
        background: #0f172a; /* Darker blue-gray for better contrast */
        color: #cbd5e1; /* Lighter text for better readability */
      }

      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
      }

      .footer-section h3 {
        font-size: 1.1rem;
        margin-bottom: 1.2rem;
        color: var(--white-color);
        font-weight: 600;
      }

      [data-theme="dark"] .footer-section h3 {
        color: #f1f5f9; /* Brighter white for headings in dark mode */
      }

      .footer-section p,
      .footer-section a {
        color: #a0aec0;
        text-decoration: none;
        line-height: 1.8;
        font-size: 0.9rem;
        transition: color var(--transition-speed);
      }

      [data-theme="dark"] .footer-section p,
      [data-theme="dark"] .footer-section a {
        color: #cbd5e1; /* Lighter gray for better readability */
      }

      .footer-section a:hover {
        color: var(--primary-color);
        text-decoration: underline;
      }

      .social-icons {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .social-icon {
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--text-light);
        transition: all var(--transition-speed);
        border: 1px solid transparent;
      }

      [data-theme="dark"] .social-icon {
        background: rgba(255, 255, 255, 0.08);
        color: #cbd5e1;
        border-color: rgba(255, 255, 255, 0.1);
      }

      .social-icon:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
      }

      .footer-bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: 2rem;
        text-align: center;
        font-size: 0.9rem;
        color: var(--text-light);
      }

      [data-theme="dark"] .footer-bottom {
        border-top-color: rgba(255, 255, 255, 0.15);
        color: #94a3b8;
      }

      /* --- Responsive Design --- */
      @media (min-width: 768px) {
        .filter-container {
          grid-template-columns: 1fr 1fr;
        }
        .full-width {
          grid-column: 1 / -1;
        }
      }
      @media (max-width: 768px) {
        .nav-links {
          display: none;
        }
      }
      @media (min-width: 992px) {
        .results-map-container {
          grid-template-columns: 40% 60%;
        }
        #map {
          height: 600px;
        }
      }
    </style>
  </head>
  <body data-theme="dark">
    <nav class="navbar" id="navbar">
      <div class="nav-container">
        <a href="/" class="logo" style="text-decoration: none"
          >Hair & Scalp AI</a
        >

        <button class="theme-toggle" id="themeToggle">
          <i class="fas fa-moon"></i>
        </button>
      </div>
    </nav>

    <main>
      <div class="container">
        <h2 class="section-title">Find a Specialist</h2>
        <p class="section-subtitle">
          Enter any location and your concern to find top-rated specialists and
          clinics near you.
        </p>

        <div class="filter-container">
          <div class="form-group full-width">
            <label for="location-autocomplete">Location</label>
            <input
              type="text"
              id="location-autocomplete"
              placeholder="Enter any address, city, or zip code"
            />
          </div>
          <div class="form-group">
            <label for="disease-select">Disease / Concern</label>
            <select id="disease-select">
              <option value="hair specialist OR dermatologist" selected>
                Any Concern
              </option>
              <option value="Alopecia Areata">Alopecia Areata</option>
              <option value="Contact Dermatitis treatment">
                Contact Dermatitis
              </option>
              <option value="Folliculitis">Folliculitis</option>
              <option value="Head Lice treatment">Head Lice</option>
              <option value="Lichen Planus treatment">Lichen Planus</option>
              <option value="Male Pattern Baldness treatment">
                Male Pattern Baldness
              </option>
              <option value="Psoriasis treatment">Psoriasis</option>
              <option value="Seborrheic Dermatitis treatment">
                Seborrheic Dermatitis
              </option>
              <option value="Telogen Effluvium treatment">
                Telogen Effluvium
              </option>
              <option value="Tinea Capitis treatment">Tinea Capitis</option>
            </select>
          </div>
          <div class="form-group">
            <label for="radius-select">Search Radius</label>
            <select id="radius-select">
              <option value="5000">5 km</option>
              <option value="10000" selected>10 km</option>
              <option value="25000">25 km</option>
              <option value="50000">50 km</option>
            </select>
          </div>
          <button class="search-button full-width" id="search-btn">
            <i class="fas fa-search"></i> Find Specialists
          </button>
        </div>

        <div class="results-map-container">
          <div class="results-container">
            <p class="no-results">Results will appear here once you search.</p>
          </div>
          <div id="map"></div>
        </div>
      </div>
    </main>

    <footer class="footer" id="contact">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Hair & Scalp AI</h3>
          <p>
            Revolutionary AI-powered platform for hair and scalp disease
            prediction and diagnosis.
          </p>
          <div class="social-icons">
            <a href="#" class="social-icon"
              ><i class="fab fa-facebook-f"></i
            ></a>
            <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
            <a
              href="https://www.linkedin.com/in/ashishsharmaas/"
              class="social-icon"
              ><i class="fab fa-linkedin-in"></i
            ></a>
            <a href="https://www.instagram.com/_.ashish__sharma._/" class="social-icon"
              ><i class="fab fa-instagram"></i
            ></a>
          </div>
        </div>

        <div class="footer-section">
          <h3>Quick Links</h3>
          <p><a href="#home">Home</a></p>
          <p><a href="#features">Features</a></p>
          <p><a href="#team">Team</a></p>
          <p><a href="#contact">Contact</a></p>
        </div>

        <div class="footer-section">
          <h3>Services</h3>
          <p><a href="#">Disease Prediction</a></p>
          <p><a href="#">Expert Consultation</a></p>
          <p><a href="#">Treatment Plans</a></p>
          <p><a href="#">Health Monitoring</a></p>
        </div>

        <div class="footer-section">
          <h3>Contact Info</h3>
          <p><i class="fas fa-envelope"></i> ashishsharma120512@gmail.com</p>
          <p><i class="fas fa-phone"></i> 9584516352</p>
          <p>
            <i class="fas fa-map-marker-alt"></i> Healthcare Innovation Center
          </p>
        </div>
      </div>

      <div class="footer-bottom">
        <p>&copy; 2025 Hair & Scalp Disease Prediction. All Rights Reserved.</p>
      </div>
    </footer>

    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkhqoQrsl48JW7EwXcV8qv2JLCzWgXqG4&libraries=places&callback=initializeApp"
    ></script>

    <script>
      // --- PAGE-SPECIFIC SCRIPT: GOOGLE MAPS ---
      let map, placesService, activeInfoWindow;
      let autocomplete;
      const markers = [];
      const resultsContainer = document.querySelector(".results-container");
      const searchBtn = document.getElementById("search-btn");
      const locationInput = document.getElementById("location-autocomplete");

      function initializeApp() {
        map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 20.5937, lng: 78.9629 },
          zoom: 5,
          mapTypeControl: false,
          streetViewControl: false,
        });
        placesService = new google.maps.places.PlacesService(map);
        autocomplete = new google.maps.places.Autocomplete(locationInput, {
          fields: ["geometry", "name"],
          types: ["(regions)"],
        });
        searchBtn.addEventListener("click", performSearch);
      }

      function performSearch() {
        const concernQuery = document.getElementById("disease-select").value;
        const place = autocomplete.getPlace();
        let searchLocation;
        if (place && place.geometry) {
          searchLocation = place.geometry.location;
        } else if (locationInput.value.trim() !== "") {
          alert(
            "Please select a valid location from the dropdown suggestions for best results."
          );
          return;
        } else {
          alert("Please enter a location to search.");
          return;
        }
        resultsContainer.innerHTML = '<p class="no-results">Searching...</p>';
        clearMarkers();
        map.setCenter(searchLocation);
        map.setZoom(12);
        const request = {
          location: searchLocation,
          radius: document.getElementById("radius-select").value,
          query: concernQuery,
        };
        placesService.textSearch(request, handlePlacesResults);
      }

      function handlePlacesResults(results, status) {
        resultsContainer.innerHTML = "";
        if (
          status === google.maps.places.PlacesServiceStatus.OK &&
          results &&
          results.length > 0
        ) {
          results.forEach((place) => {
            createMarker(place);
            createClinicCard(place);
          });
        } else {
          resultsContainer.innerHTML =
            '<p class="no-results">No specialists found. Please try a different location or concern.</p>';
        }
      }

      function createMarker(place) {
        if (!place.geometry || !place.geometry.location) return;
        const marker = new google.maps.Marker({
          map,
          position: place.geometry.location,
          title: place.name,
          animation: google.maps.Animation.DROP,
        });
        const infoWindow = new google.maps.InfoWindow({
          content: `<div><b>${place.name}</b><br>${place.formatted_address}</div>`,
        });
        marker.addListener("click", () => {
          if (activeInfoWindow) activeInfoWindow.close();
          infoWindow.open(map, marker);
          activeInfoWindow = infoWindow;
          highlightCard(place.place_id, true);
        });
        markers.push(marker);
      }
      function createClinicCard(place) {
        // 1. Create the basic card structure immediately
        const card = document.createElement("div");
        card.className = "clinic-card";
        card.id = `place-${place.place_id}`;
        card.innerHTML = `<h3>${place.name}</h3><p>Loading details...</p>`; // Show a loading message
        resultsContainer.appendChild(card);

        // 2. Define the request for detailed information
        const detailsRequest = {
          placeId: place.place_id,
          // Specify the fields you want to retrieve
          fields: [
            "name",
            "formatted_address",
            "rating",
            "user_ratings_total",
            "formatted_phone_number",
            "website",
            "geometry",
          ],
        };

        // 3. Fetch the detailed information from the Places API
        placesService.getDetails(detailsRequest, (placeDetails, status) => {
          if (
            status === google.maps.places.PlacesServiceStatus.OK &&
            placeDetails
          ) {
            // Conditionally create HTML for rating, phone, and website if they exist
            const ratingHTML = placeDetails.rating
              ? `<li class="rating"><i class="fas fa-star"></i> ${placeDetails.rating} (${placeDetails.user_ratings_total} reviews)</li>`
              : "";

            const phoneHTML = placeDetails.formatted_phone_number
              ? `<li><i class="fas fa-phone"></i> <a href="tel:${placeDetails.formatted_phone_number}">${placeDetails.formatted_phone_number}</a></li>`
              : "";

            const websiteHTML = placeDetails.website
              ? `<li><i class="fas fa-globe"></i> <a href="${placeDetails.website}" target="_blank" rel="noopener noreferrer">Visit Website</a></li>`
              : "";

            // 4. Update the card's inner HTML with all the details
            card.innerHTML = `
                        <h3>${placeDetails.name}</h3>
                        <ul class="clinic-info">
                            <li><i class="fas fa-map-marker-alt"></i> ${
                              placeDetails.formatted_address ||
                              "Address not available"
                            }</li>
                            ${ratingHTML}
                            ${phoneHTML}
                            ${websiteHTML}
                        </ul>`;

            // 5. Add the click event listener after the content is loaded
            card.addEventListener("click", () => {
              map.setCenter(placeDetails.geometry.location);
              map.setZoom(15);
              const correspondingMarker = markers.find(
                (m) => m.getTitle() === placeDetails.name
              );
              if (correspondingMarker) {
                new google.maps.event.trigger(correspondingMarker, "click");
              }
            });
          } else {
            // If details fail to load, update the card with an error
            card.innerHTML = `<h3>${place.name}</h3><p>Could not load details.</p>`;
          }
        });
      }

      function clearMarkers() {
        markers.forEach((marker) => marker.setMap(null));
        markers.length = 0;
      }

      function highlightCard(placeId, shouldScroll) {
        document
          .querySelectorAll(".clinic-card")
          .forEach((c) => c.classList.remove("highlighted"));
        const cardToHighlight = document.getElementById(`place-${placeId}`);
        if (cardToHighlight) {
          cardToHighlight.classList.add("highlighted");
          if (shouldScroll)
            cardToHighlight.scrollIntoView({
              behavior: "smooth",
              block: "center",
            });
        }
      }

      // --- GLOBAL SCRIPTS (from home.html) ---
      // Navbar scroll effect
      window.addEventListener("scroll", () => {
        const navbar = document.getElementById("navbar");
        if (window.scrollY > 50) {
          navbar.classList.add("scrolled");
        } else {
          navbar.classList.remove("scrolled");
        }
      });

      // Theme Toggle
      const themeToggle = document.getElementById("themeToggle");
      const body = document.body;
      themeToggle.addEventListener("click", () => {
        const currentTheme = body.dataset.theme === "dark" ? "light" : "dark";
        body.dataset.theme = currentTheme;
        const icon = themeToggle.querySelector("i");
        icon.className = currentTheme === "dark" ? "fas fa-sun" : "fas fa-moon";
      });
    </script>
    <script>
      window.chtlConfig = { chatbotId: "8383945963" };
    </script>
    <script
      async
      data-id="8383945963"
      id="chtl-script"
      type="text/javascript"
      src="https://chatling.ai/js/embed.js"
    ></script>
  </body>
</html>
